const wrapper=document.querySelectorAll(".keyboard_wrapper> div");let i=1,cursor_position=null;function Backspace(){textarea.innerHTML=textarea.innerHTML.slice(0,cursor_position-1)+textarea.innerHTML.slice(cursor_position,textarea.innerHTML.length),textarea.selectionStart=--cursor_position}function getCaretPos(){return textarea.focus(),!1!==textarea.selectionStart?textarea.selectionStart:0}function printChar(t){textarea.innerHTML=textarea.innerHTML.slice(0,cursor_position)+t+textarea.innerHTML.slice(cursor_position,textarea.innerHTML.length),textarea.selectionStart=++cursor_position}alert("Привет. Нужно кое-что допилить. Пожалуйста не спиши проверять. Крайний срок вроде как до четверга включительно. Вот мой телеграмм для связи https://t.me/Roman914"),document.addEventListener("DOMContentLoaded",(()=>{textarea.focus()})),textarea.addEventListener("blur",(()=>{textarea.focus()})),textarea.addEventListener("click",(t=>{cursor_position=getCaretPos()})),textarea.addEventListener("keydown",(t=>{t.preventDefault()})),wrapper.forEach((t=>{t.addEventListener("click",(t=>{let e=t.target;if(cursor_position=getCaretPos(),e.classList.contains("services_btn")||printChar(t.target.innerHTML),e.classList.contains("Backspace")&&Backspace(),e.classList.contains("Tab")&&printChar("\t"),e.classList.contains("Space")&&printChar(" "),e.classList.contains("Enter")&&printChar("\n"),e.classList.contains("Delete")&&(textarea.innerHTML=textarea.innerHTML.slice(0,cursor_position)+textarea.innerHTML.slice(cursor_position+1,textarea.innerHTML.length),textarea.selectionStart=cursor_position),e.classList.contains("CapsLock")){const t=document.querySelectorAll('[class*="Key"]');if("true"===e.getAttribute("data-val")){for(let e of t)e.innerHTML=e.innerHTML.toLowerCase();e.removeAttribute("data-val")}else{for(let e of t)e.innerHTML=e.innerHTML.toUpperCase();e.dataset.val="true"}}}))})),textarea.addEventListener("keydown",(t=>{wrapper.forEach((e=>{if(e.classList.contains(t.code)&&(e.classList.add("active"),e.classList.contains("services_btn")||printChar(e.innerHTML),e.classList.contains("Backspace")&&Backspace(),e.classList.contains("Tab")&&printChar("\t"),e.classList.contains("Space")&&printChar(" "),e.classList.contains("Enter")&&printChar("\n"),e.classList.contains("Delete")&&(textarea.innerHTML=textarea.innerHTML.slice(0,cursor_position)+textarea.innerHTML.slice(cursor_position+1,textarea.innerHTML.length),textarea.selectionStart=cursor_position),e.classList.contains("CapsLock"))){const t=document.querySelectorAll('[class*="Key"]');if("true"===e.getAttribute("data-val")){for(let e of t)e.innerHTML=e.innerHTML.toLowerCase();e.removeAttribute("data-val")}else{for(let e of t)e.innerHTML=e.innerHTML.toUpperCase();e.dataset.val="true"}}}))})),textarea.addEventListener("keyup",(t=>{wrapper.forEach((t=>{t.classList.remove("active")}))}));